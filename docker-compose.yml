version: '3.8'

services:
  callcenter-app:
    build: .
    container_name: callcenter-web
    ports:
      - "8080:4000"
    env_file:
      - .env
    environment:
      - PORT=4000
      - DOCKER=true
      # Las variables se cargan desde .env usando env_file
      # Si necesitas sobrescribir alguna, úsala aquí
      - DB_ENCRYPT=${DB_ENCRYPT:-true}
      - DB_TRUST_CERT=${DB_TRUST_CERT:-true}
    volumes:
      # Montar carpeta uploads para persistir vouchers
      # La carpeta ./uploads del host se monta en /app/uploads del contenedor
      # Esto asegura que los archivos persistan aunque se reinicie el contenedor
      - ./uploads:/app/uploads
    restart: unless-stopped
    # Si SQL Server está en otra máquina, descomenta y ajusta:
    # extra_hosts:
    #   - "win-1slfd3ac22a:IP_DEL_SERVIDOR_SQL"
    networks:
      - callcenter-network

networks:
  callcenter-network:
    driver: bridge

