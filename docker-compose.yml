version: '3.8'

services:
  callcenter-app:
    build: .
    container_name: callcenter-web
    ports:
      - "8080:5000"
    environment:
      - PORT=5000
      - DOCKER=true
      - DB_SERVER=${DB_SERVER}
      - DB_USER=${DB_USER}
      - DB_PASSWORD=${DB_PASSWORD}
      - DB_NAME=${DB_NAME}
      - DB_ENCRYPT=${DB_ENCRYPT:-true}
      - DB_TRUST_CERT=${DB_TRUST_CERT:-true}
    volumes:
      # Montar carpeta uploads para persistir vouchers
      # La carpeta ./uploads del host se monta en /app/uploads del contenedor
      # Esto asegura que los archivos persistan aunque se reinicie el contenedor
      - ./uploads:/app/uploads
    restart: unless-stopped
    # Si SQL Server está en otra máquina, descomenta y ajusta:
    # extra_hosts:
    #   - "win-1slfd3ac22a:IP_DEL_SERVIDOR_SQL"
    networks:
      - callcenter-network

networks:
  callcenter-network:
    driver: bridge

